<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="GREåœ–åƒè¨˜æ†¶">
    <title>GRE Visual Memory</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --bg: #f0f2f5;
            --card-bg: #ffffff;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
            -webkit-tap-highlight-color: transparent;
        }

        h1 { 
            color: var(--primary); 
            margin-top: 10px; 
            font-size: 1.4rem;
            text-align: center;
            margin-bottom: 5px;
        }
        
        .stats { color: #7f8c8d; margin-bottom: 15px; font-size: 0.85em; }

        /* å¡ç‰‡å®¹å™¨ */
        .card-container {
            background: var(--card-bg);
            width: 100%;
            max-width: 400px;
            /* è®“å¡ç‰‡é«˜åº¦æ›´æœ‰å½ˆæ€§ä»¥å®¹ç´åœ–ç‰‡ */
            min-height: 400px; 
            border-radius: 24px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
            justify-content: flex-start; /* æ”¹ç‚ºå¾ä¸Šé–‹å§‹æ’ */
            align-items: center;
            padding: 25px;
            text-align: center;
            position: relative;
            flex-grow: 1; 
            margin-bottom: 20px;
            overflow: hidden;
        }

        /* åœ–ç‰‡æ¨£å¼ */
        .word-image {
            width: 100%;
            height: 200px;
            object-fit: cover; /* ä¿æŒåœ–ç‰‡æ¯”ä¾‹ä¸¦å¡«æ»¿ */
            border-radius: 12px;
            margin-bottom: 20px;
            background-color: #eee;
            display: none; /* é è¨­éš±è—ï¼Œæœ‰é€£çµæ‰é¡¯ç¤º */
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .word { font-size: 2.4em; font-weight: 800; color: var(--primary); margin-bottom: 5px; line-height: 1.1; }
        .phonetic { color: #95a5a6; margin-bottom: 15px; font-family: "Menlo", monospace; font-size: 1.1em; }
        
        .definition { 
            font-size: 1.25em; 
            margin-bottom: 15px; 
            color: #2c3e50; 
            display: none; 
            font-weight: 600;
        }
        .example {
            font-size: 1em;
            color: #57606f;
            font-style: italic;
            display: none;
            margin-bottom: 20px;
            line-height: 1.5;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            width: 100%;
            box-sizing: border-box;
        }

        .btn-group { 
            display: flex; 
            gap: 12px; 
            width: 100%; 
            position: sticky;
            bottom: 20px;
            z-index: 10;
        }
        
        button {
            border: none;
            padding: 16px 0;
            border-radius: 14px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: transform 0.1s, opacity 0.2s;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        button:active { transform: scale(0.96); }

        #show-answer { background-color: var(--primary); color: white; width: 100%; }
        
        .rating-btns { display: none; width: 100%; justify-content: space-between; gap: 10px;}
        .btn-hard { background-color: #e74c3c; color: white; flex: 1; }
        .btn-good { background-color: #f39c12; color: white; flex: 1; }
        .btn-easy { background-color: #27ae60; color: white; flex: 1; }

        .progress-container {
            width: 100%;
            max-width: 400px;
            background-color: #dfe6e9;
            border-radius: 10px;
            height: 6px;
            overflow: hidden;
            margin-bottom: 8px;
        }
        .progress-bar {
            height: 100%;
            background-color: var(--accent);
            width: 0%;
            transition: width 0.5s ease-out;
        }
        
        .empty-state { display: none; margin-top: 50px; }

    </style>
</head>
<body>

    <h1>GRE åœ–åƒè¨˜æ†¶</h1>
    <div class="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
    </div>
    <div class="stats">å¾…è¤‡ç¿’: <span id="due-count">0</span> / <span id="total-count">0</span></div>

    <div class="card-container" id="card">
        <img id="word-img" class="word-image" src="" alt="word image">

        <div class="word" id="word-text">Loading...</div>
        <div class="phonetic" id="word-phonetic"></div>
        <div class="definition" id="word-def"></div>
        <div class="example" id="word-ex"></div>
        
        <div class="empty-state" id="empty-msg">
            <div style="font-size: 3em; margin-bottom: 20px;">ğŸ‰</div>
            <h2>ä»Šæ—¥ä»»å‹™å®Œæˆï¼</h2>
            <p>ä¼‘æ¯æ˜¯è¨˜æ†¶çš„ä¸€éƒ¨åˆ†</p>
            <button onclick="resetData()" style="background:#bdc3c7; margin-top:30px; padding:10px 20px; color:white; box-shadow:none;">é‡ç½®é€²åº¦</button>
        </div>
    </div>

    <div class="btn-group">
        <button id="show-answer" onclick="showAnswer()">é¡¯ç¤ºç­”æ¡ˆ</button>
        <div class="rating-btns" id="rating-btns">
            <button class="btn-hard" onclick="rateWord(1)">å¿˜è¨˜</button>
            <button class="btn-good" onclick="rateWord(2)">æ¨¡ç³Š</button>
            <button class="btn-easy" onclick="rateWord(3)">ç§’æ®º</button>
        </div>
    </div>

    <script>
        // 1. é è¨­ GRE å–®å­—åº« (åŒ…å« img å±¬æ€§)
        // æ³¨æ„ï¼šé€™è£¡çš„åœ–ç‰‡é€£çµä¾†è‡ª Unsplash Sourceï¼Œé€™æ˜¯å…è²»åœ–åº«
        const defaultWords = [
            { 
                id: 1, 
                word: "Abate", 
                phonetic: "/É™ËˆbeÉªt/", 
                def: "v. æ¸›è¼•ï¼›æ¸›å°‘", 
                ex: "The storm suddenly abated.",
                // æš´é¢¨é›¨æ¸›å¼±çš„åœ–
                img: "https://images.unsplash.com/photo-1516912481808-3406841bd33c?w=500&q=80" 
            },
            { 
                id: 2, 
                word: "Cacophony", 
                phonetic: "/kÉ™ËˆkÉ’f.É™.ni/", 
                def: "n. åˆºè€³çš„è²éŸ³", 
                ex: "A cacophony of deafening alarm bells.",
                // åŸå¸‚å™ªéŸ³æˆ–æ··äº‚çš„åœ–
                img: "https://images.unsplash.com/photo-1519810725537-c3b886915181?w=500&q=80"
            },
            { 
                id: 3, 
                word: "Enervate", 
                phonetic: "/Ëˆen.É™.veÉªt/", 
                def: "v. ä½¿è¡°å¼±ï¼›ä½¿ç„¡åŠ›", 
                ex: "The hot sun enervated her.",
                // ç–²ç´¯çš„äºº
                img: "https://images.unsplash.com/photo-1473280025148-b4371720d480?w=500&q=80"
            },
            { 
                id: 4, 
                word: "Paradox", 
                phonetic: "/ËˆpÃ¦r.É™.dÉ’ks/", 
                def: "n. æ‚–è«–ï¼›çŸ›ç›¾", 
                ex: "It is a paradox that such a rich country has so much poverty.",
                // çŸ›ç›¾æ¦‚å¿µåœ–
                img: "https://images.unsplash.com/photo-1535905557558-afc4877a26fc?w=500&q=80"
            },
            { 
                id: 5, 
                word: "Zeal", 
                phonetic: "/ziËl/", 
                def: "n. ç†±èª ï¼›ç†±æƒ…", 
                ex: "His zeal for what he calls 'real food' is infectious.",
                // ç†±æƒ…çš„äºº
                img: "https://images.unsplash.com/photo-1542596768-5d1d21f1cfb6?w=500&q=80"
            }
        ];

        let words = [];
        let currentWordIndex = null;
        let dueWords = [];

        function init() {
            // ä½¿ç”¨ä¸åŒçš„ key ä¾†å€åˆ†æ˜¯å¦æœ‰åœ–ç‰‡çš„ç‰ˆæœ¬
            const stored = localStorage.getItem('gre_vocab_img_data'); 
            if (stored) {
                words = JSON.parse(stored);
            } else {
                words = defaultWords.map(w => ({
                    ...w,
                    nextReview: Date.now(),
                    interval: 0,
                    repetitions: 0
                }));
                saveData();
            }
            loadDueWords();
        }

        function loadDueWords() {
            const now = Date.now();
            dueWords = words.filter(w => w.nextReview <= now);
            
            document.getElementById('due-count').innerText = dueWords.length;
            document.getElementById('total-count').innerText = words.length;
            
            const progress = ((words.length - dueWords.length) / words.length) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;

            if (dueWords.length > 0) {
                showNextCard();
            } else {
                showEmptyState();
            }
        }

        function showNextCard() {
            const randomIndex = Math.floor(Math.random() * dueWords.length);
            const wordObj = dueWords[randomIndex];
            currentWordIndex = words.findIndex(w => w.id === wordObj.id);

            // è¨­å®šæ–‡å­—
            document.getElementById('word-text').innerText = wordObj.word;
            document.getElementById('word-phonetic').innerText = wordObj.phonetic;
            document.getElementById('word-def').innerText = wordObj.def;
            document.getElementById('word-ex').innerText = wordObj.ex;

            // è¨­å®šåœ–ç‰‡ logic
            const imgEl = document.getElementById('word-img');
            if (wordObj.img && wordObj.img.trim() !== "") {
                imgEl.src = wordObj.img;
                imgEl.style.display = 'block';
            } else {
                imgEl.style.display = 'none'; // å¦‚æœæ²’åœ–ç‰‡é€£çµå°±éš±è—
            }

            // ç‹€æ…‹é‡ç½®
            document.getElementById('word-def').style.display = 'none';
            document.getElementById('word-ex').style.display = 'none';
            document.getElementById('show-answer').style.display = 'block';
            document.getElementById('rating-btns').style.display = 'none';
            document.getElementById('card').style.display = 'flex';
            document.getElementById('empty-msg').style.display = 'none';
            
            document.querySelector('.btn-group').style.display = 'flex';
        }

        function showAnswer() {
            document.getElementById('word-def').style.display = 'block';
            document.getElementById('word-ex').style.display = 'block';
            document.getElementById('show-answer').style.display = 'none';
            document.getElementById('rating-btns').style.display = 'flex';
        }

        function rateWord(quality) {
            const word = words[currentWordIndex];
            const now = Date.now();
            const oneDay = 24 * 60 * 60 * 1000;

            if (quality === 1) { 
                word.interval = 1; 
                word.repetitions = 0;
            } else if (quality === 2) { 
                word.interval = word.interval === 0 ? 3 : Math.ceil(word.interval * 1.5);
                word.repetitions += 1;
            } else if (quality === 3) { 
                word.interval = word.interval === 0 ? 7 : Math.ceil(word.interval * 2.5);
                word.repetitions += 1;
            }

            word.nextReview = now + (word.interval * oneDay);
            saveData();
            loadDueWords();
        }

        function showEmptyState() {
            document.getElementById('card').style.display = 'none'; // éš±è—å¡ç‰‡
            document.querySelector('.btn-group').style.display = 'none';
            
            // è®“ç©ºç‹€æ…‹é¡¯ç¤ºåœ¨ç•«é¢ä¸­é–“
            const container = document.getElementById('card').parentNode;
            let emptyEl = document.getElementById('empty-msg-standalone');
            
            // é€™è£¡ç°¡å–®è™•ç†ï¼šç›´æ¥ç”¨åŸæœ¬å¡ç‰‡è£¡çš„ç©ºç‹€æ…‹
            document.getElementById('card').style.display = 'flex';
            document.getElementById('word-img').style.display = 'none';
            document.getElementById('word-text').parentElement.querySelectorAll('.word, .phonetic, .definition, .example').forEach(el => el.style.display = 'none');
            document.getElementById('empty-msg').style.display = 'block';
        }

        function saveData() {
            localStorage.setItem('gre_vocab_img_data', JSON.stringify(words));
        }

        function resetData() {
            if(confirm('ç¢ºå®šè¦é‡ç½®æ‰€æœ‰å­¸ç¿’ç´€éŒ„å—ï¼Ÿ')) {
                localStorage.removeItem('gre_vocab_img_data');
                location.reload();
            }
        }

        init();
    </script>
</body>
</html>
